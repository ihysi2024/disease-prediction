<!DOCTYPE html>
<!-- saved from url=(0082)https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html -->
<html coupert-item="9AF8D9A4E502F3784AD24272D81F0381"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=0.8"><title>Lecture 17: The Strategy and Decorator Patterns</title><link rel="stylesheet" type="text/css" href="./tictactoefinal_files/scribble.css" title="default"><link rel="stylesheet" type="text/css" href="./tictactoefinal_files/footnote.css" title="default"><link rel="stylesheet" type="text/css" href="./tictactoefinal_files/screen.css" title="default"><link rel="stylesheet" type="text/css" href="./tictactoefinal_files/manual-racket.css" title="default"><script type="text/javascript" src="./tictactoefinal_files/scribble-common.js.download"></script><script type="text/javascript" src="./tictactoefinal_files/manual-racket.js.download"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--><script src="./tictactoefinal_files/jquery.min.js.download"></script><script>$.noConflict();</script><script type="text/x-mathjax-config;executed=true">MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX", "output/HTML-CSS"],
  tex2jax: {
    inlineMath: [ ["$","$"], ["\\(","\\)"] ],
    displayMath: [ ["$$","$$"],
                   ["\\[","\\]"],
                   ["\\begin{equation}","\\end{equation}"],
                   ["\\begin{equation*}","\\end{equation*}"] ],
    processEscapes: true
  },
  "HTML-CSS": {
    availableFonts: [],
    webFont: "Asana-Math",
    preferredFont: "Asana-Math",
    imageFont: null,
    mtexFontInherit: true
  }
});</script><script src="./tictactoefinal_files/MathJax.js.download"></script><script src="./tictactoefinal_files/prism.js.download"></script><script src="./tictactoefinal_files/runmode.js.download"></script><script src="./tictactoefinal_files/scheme.js.download"></script><script src="./tictactoefinal_files/clike.js.download"></script><link type="image/png" rel="icon" href="https://course.khoury.northeastern.edu/cs3500/Sky_and_Water_I.png"><link type="text/css" rel="stylesheet" href="./tictactoefinal_files/screen.css"><link type="text/css" rel="stylesheet" href="./tictactoefinal_files/prism.css"><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head><body id="scribble-racket-lang-org"><div id="MathJax_Message" style="display: none;"></div><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tbody><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">►</a></td><td></td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html" class="tocviewselflink" data-pltdoc="x"><span class="LectureNum">Lecture 17:</span> The Strategy and Decorator Patterns</a></td></tr></tbody></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tbody><tr><td align="right"></td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Objectives_of_the_lecture%29" class="tocviewlink" data-pltdoc="x">Objectives of the lecture</a></td></tr><tr><td align="right">1&nbsp;</td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.The_strategy_pattern%29" class="tocviewlink" data-pltdoc="x">The strategy pattern</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._avoiding-null%29" class="tocviewlink" data-pltdoc="x">Avoiding <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span>:<span class="mywbr"> &nbsp;</span> Multiple strategy signatures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.The_decorator_pattern%29" class="tocviewlink" data-pltdoc="x">The decorator pattern</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Strategies__.Decorators_and_.Inheritance%29" class="tocviewlink" data-pltdoc="x">Strategies, Decorators and Inheritance</a></td></tr></tbody></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tbody><tr><td><span class="tocsublinknumber"></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._%29" class="tocsubseclink" data-pltdoc="x"><span class="LectureNum">Lecture 17:</span> The Strategy and Decorator Patterns</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Objectives_of_the_lecture%29" class="tocsubseclink" data-pltdoc="x">Objectives of the lecture</a></td></tr><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.The_strategy_pattern%29" class="tocsubseclink" data-pltdoc="x">The strategy pattern</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.A_strategy_is_just_a_function_object%29" class="tocsubseclink" data-pltdoc="x">A strategy is just a function object</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Strategies_can_be_composed%29" class="tocsubseclink" data-pltdoc="x">Strategies can be composed</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Strategies_can_be_dynamically_selected%29" class="tocsubseclink" data-pltdoc="x">Strategies can be dynamically selected</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Strategies_make_for_easy_testing%29" class="tocsubseclink" data-pltdoc="x">Strategies make for easy testing</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._avoiding-null%29" class="tocsubseclink" data-pltdoc="x">Avoiding <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span>:<span class="mywbr"> &nbsp;</span> Multiple strategy signatures</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.The_decorator_pattern%29" class="tocsubseclink" data-pltdoc="x">The decorator pattern</a></td></tr><tr><td><span class="tocsublinknumber">4<tt>&nbsp;</tt></span><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._.Strategies__.Decorators_and_.Inheritance%29" class="tocsubseclink" data-pltdoc="x">Strategies, Decorators and Inheritance</a></td></tr></tbody></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">8.9</span></div><h2><a name="(part._)"></a><span class="LectureNum">Lecture 17:</span> The Strategy and Decorator Patterns</h2><nav class="SubFlow screenonly links"><ul><li><p><a href="https://course.khoury.northeastern.edu/cs3500/lec/strategies_decorators/code.zip">Java source (.zip)</a></p></li></ul></nav><h3><a name="(part._.Objectives_of_the_lecture)"></a>Objectives of the lecture</h3><p>This lecture introduces two design patterns: strategy and decorators. Both patterns are
useful to enhance existing operations and implement combinations of existing implementations
of operations.</p><p>The <span class="emph">strategy</span> and <span class="emph">decorator</span> patterns are very similar idioms of
using delegation to refactor aspects of a class’s behavior into separate
classes, for easier enhancement or modification, and tighter cohesiveness.  The
strategy pattern is somewhat more intuitive to motivate with real-world
examples, so we’ll start there.</p><h3>1<tt>&nbsp;</tt><a name="(part._.The_strategy_pattern)"></a>The strategy pattern</h3><p></p><p>Let’s consider a straightforward game for which the technique for winning is
easily, thoroughly mastered: TicTacToe.  How might we play this game?  Here are
some ideas:
</p><ul><li><p>Play in an open square</p></li><li><p>Play to an open corner</p></li><li><p>Block the opponent from winning</p></li><li><p>Place a third piece in a row to win</p></li></ul><p></p><p></p><p>All but the first of these aren’t complete strategies.  If the corners are all
full, for instance, then the second approach doesn’t have any recommendation to
make.  So perhaps more accurately, our <span class="emph">complete</span> strategies might be:
</p><ul><li><p>Play in an open square</p></li><li><p>Play to an open corner, or else play in an open square</p></li><li><p>Block the opponent from winning if they’re about to, otherwise play
to an open corner, otherwise just play to an open square</p></li><li><p>Place a third piece in a row to win, or else block the opponent if
they’re about to win, or else play in an open corner, or else just
play to an open square</p></li></ul><p></p><p>It’s probably intuitively clear to you, as an expert human player of TicTacToe,
that the final strategy above is pretty good.<span class="Footnote"><span class="FootnoteRef"><span style="vertical-align: super; font-size: 80%"><a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28counter-%28%29._%28gentag._17._lecturestrategies_decorators%29%29" data-pltdoc="x">1</a></span></span><span class="FootnoteContent">It’s not perfect —<wbr> suppose
two players were following this same strategy.  Would the game end in a win,
loss, or tie for the first player? How could you fix any problems you might
encounter?</span></span> How might we implement these strategies?</p><h4>1.1<tt>&nbsp;</tt><a name="(part._.A_strategy_is_just_a_function_object)"></a>A strategy is just a function object</h4><p>Suppose in our program we had a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">TicTacToeModel</span></code></span> containing the board
state, and a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">Piece</span></code></span> enumeration naming <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">X</span></code></span> and <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">O</span></code></span>.  Our program
also contains two <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">Player</span></code></span> objects (one for each <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">Piece</span></code></span>), which may
call the model’s <span class="sourceCode"><code class=" sourceCode language-java"><span class="token function">playMove</span><span class="token punctuation">(</span><span class="token class-name">Piece</span> player<span class="token punctuation">,</span> <span class="token keyword">int</span> row<span class="token punctuation">,</span> <span class="token keyword">int</span> col<span class="token punctuation">)</span></code></span> method to make
a move.  How should the <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">Player</span></code></span>s choose where to move?  What information
would be needed to make an informed choice?  We’d need to know the state of the
board, and also know which player we’re trying to choose a move for:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">Coord</span> <span class="token punctuation">{</span>
  <span class="token keyword">int</span> row<span class="token punctuation">;</span>
  <span class="token keyword">int</span> col
<span class="token punctuation">}</span>
<span class="token keyword">interface</span> <span class="token class-name">TicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>Implementing our first strategy is pretty easy.  It doesn’t care who it’s
choosing a move for; it just seeks out the first open square:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">AnyOpenSquare</span> <span class="token keyword">implements</span> <span class="token class-name">TicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>(<span class="emph">Note:</span> we are returning <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span> at the moment to indicate the lack
of an available move.  This <span class="emph">not</span> a great idea – might consider throwing
an exception instead, to indicate that our strategy could not succeed.  But see
<a href="https://course.khoury.northeastern.edu/cs3500/lec_strategies_decorators_notes.html#%28part._avoiding-null%29" data-pltdoc="x">Avoiding <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span>: Multiple strategy signatures</a> below for a better approach still.)</p><p>How might we implement the second strategy?  We could implement the entirety of
the logic (choose corners or else choose random), but part of that logic has
been implemented already...  Let’s implement just the new part, first:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">AnyOpenCorner</span> <span class="token keyword">implements</span> <span class="token class-name">TicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>                                     <span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span><span class="token operator">?</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>How might we fill in the question-marks?  This strategy looks for an open
corner, but if it can’t find one, it needs to use another approach to pick a
response.  Fortunately, we have such an approach already: we could reuse
<span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">AnyOpenSquare</span></code></span>!</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">AnyOpenCorner</span> <span class="token keyword">implements</span> <span class="token class-name">TicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>
       <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>This resolves the question-marks, at the cost of hardcoding <span class="emph">which</span>
fallback mechanism to choose.  But we can definitely be more flexible.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._.Strategies_can_be_composed)"></a>Strategies can be composed</h4><p>The any-open-square strategy and the any-open-corner strategy are both
functions that take in a board state and return a coordinate to move.  We can
easily, and <span class="emph">generally</span>, combine the two of them into a higher-order
strategy that first tries one and then, if it fails, tries the other:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">TryTwo</span> <span class="token keyword">implements</span> <span class="token class-name">TicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">TicTacToeStrategy</span> first<span class="token punctuation">,</span> second<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Coord</span> ans <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ans <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> ans<span class="token punctuation">;</span> <span class="token comment">// the first strategy succeeded</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>second<span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>If we fill in the question-marks in <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">AnyOpenCorner</span></code></span> with <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">return</span>
<span class="token keyword">null</span></code></span>, as we effectively did with <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">AnyOpenSquare</span></code></span>, then our full second
strategy is simply <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AnyOpenCorner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></span>.
We can continue implementing the other strategy components (blocking an
opponent, or going for an immediate win), and combining them with
<span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">TryTwo</span></code></span>.  (These other components need the <span class="sourceCode"><code class=" sourceCode language-java">forWhom</code></span> argument —<wbr>
try implementing them yourself.)</p><p>More broadly, strategies can be composed in lots of different ways, analogous
to mapping, and-map, or-map, or other higher-order combinations.  We can
generalize from <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">TryTwo</span></code></span> to <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">TryMany</span></code></span> (that takes a list of
strategies); we can generalize to randomly selecting among several strategies,
or more sophisticated choices among several strategies.  We might possibly
try a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">BestOfThree</span></code></span> strategy that take in three strategies, try
them all, and pick the value that at least two strategies agreed on.  The
possibilities here are vast.</p><h4>1.3<tt>&nbsp;</tt><a name="(part._.Strategies_can_be_dynamically_selected)"></a>Strategies can be dynamically selected</h4><p>Suppose we wanted to build a TicTacToe game for players of varying ability, and
wanted “easy”, “medium”, and “hard” difficulty levels.  We could easily
mix and match compositions among the four simple strategies above, and
dynamically assign some such object at runtime:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token class-name">User</span> computerUser <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span>
<span class="token class-name">Strategy</span> easy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlayToWin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Strategy</span> medium <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlayToWin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DontLose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Strategy</span> hard <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlayToWin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DontLose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AnyOpenCorner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>difficulty <span class="token operator">==</span> EASY<span class="token punctuation">)</span>
  computerUser<span class="token punctuation">.</span><span class="token function">playStrategy</span><span class="token punctuation">(</span>easy<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>difficulty <span class="token operator">==</span> MEDIUM<span class="token punctuation">)</span>
  computerUser<span class="token punctuation">.</span><span class="token function">playStrategy</span><span class="token punctuation">(</span>medium<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
  computerUser<span class="token punctuation">.</span><span class="token function">playStrategy</span><span class="token punctuation">(</span>hard<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p></p><p>Rather than hardcoding the difficulty level of the game, we have refactored it
out and made it easily configurable.</p><p>We can also define an <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">AskUser</span></code></span> strategy...and now we have something the
controller can use to interact with a human player, in the same framework as
these other strategy choices.</p><p>(Note that in this scenario, the composition of strategies could be rearranged:
</p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlayToWin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">DontLose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
           <span class="token keyword">new</span> <span class="token class-name">TryTwo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">PlayToCorner</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">AnyOpenSquare</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></div><p></p><p>behaves exactly the same as our <span class="sourceCode"><code class=" sourceCode language-java">hard</code></span> strategy above, even though the
component strategies are arranged in a tree instead of a list.  Depending on
which combinations you pick, there may easily be many ways to express the
desired result.)</p><h4>1.4<tt>&nbsp;</tt><a name="(part._.Strategies_make_for_easy_testing)"></a>Strategies make for easy testing</h4><p>If we supply two strategies to our controller and say “play the game with two
players using these respective strategies”, what could happen?  If both
strategies are fully automatic, then we’ve built a great test harness to run
through the game automatically!  Combining this with the <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">Appendable</span></code></span>
output we’ve seen in earlier lectures, and we have a straightforward means to
simulate a playthrough of the game.  Moreover, testing different strategies
against each other lets us not only test whether they work properly, but also
how well they do at playing the game.</p><h3>2<tt>&nbsp;</tt><a name="(part._avoiding-null)"></a>Avoiding <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span>: Multiple strategy signatures</h3><p>Above, we built four <span class="emph">partial</span> strategies, that worked when possible and
returned <span class="sourceCode"><code class=" sourceCode language-java"><span class="token keyword">null</span></code></span> otherwise.  This is a bad idea, since the <span class="emph">user</span> of
these strategies is forced to check for nullness before using the result.  But
it’s a mistake of our own making: we chose a return type for our strategy that
didn’t include the possibility of failure.  A <span class="emph">complete</span> strategy in this
game will always be able to choose a place to play (assuming any open places
remain).  But partial strategies might not always be able to do so.</p><p>Accordingly, since these are now two different purpose statements ("Find me a
place!" versus "Try to find a place if you can"), we might encode them as two
different strategy interfaces:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token comment">// An interface describing strategies whose return value cannot fail:</span>
<span class="token comment">// they will always return a non-null Coord, or else</span>
<span class="token comment">// throw an excpetion if they're called on a game that cannot have a move</span>
<span class="token keyword">interface</span> <span class="token class-name">InfallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// An interface describing incomplete or partial strategies, that</span>
<span class="token comment">// might successfully choose a move and might not.</span>
<span class="token keyword">interface</span> <span class="token class-name">FallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>Then our partial strategies above would be better written as</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">AnyOpenSquare</span> <span class="token keyword">implements</span> <span class="token class-name">FallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> r <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> r <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> r<span class="token operator">++</span><span class="token punctuation">)</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> c <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> c <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">;</span> c<span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">AnyOpenCorner</span> <span class="token keyword">implements</span> <span class="token class-name">FallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token keyword">public</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>model<span class="token punctuation">.</span><span class="token function">getPieceAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Coord</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">else</span>                                     <span class="token keyword">return</span> <span class="token class-name">Optional</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">TryTwo</span> <span class="token keyword">implements</span> <span class="token class-name">FallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">FallibleTicTacToeStrategy</span> first<span class="token punctuation">,</span> second<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> ans <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ans<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> ans<span class="token punctuation">;</span> <span class="token comment">// the first strategy succeeded</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>second<span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><p>Ultimately, our <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">User</span></code></span> wants a <span class="emph">complete</span> strategy, not one that can
fail.  So we need a way to convert our fallible strategies into an infallible
one:</p><p></p><div class="sourceCode"><pre data-lang="java" class="sourceCode language-java"><code class=" sourceCode language-java"><span class="token keyword">class</span> <span class="token class-name">CompleteStrategyFromFallible</span> <span class="token keyword">implements</span> <span class="token class-name">InfallibleTicTacToeStrategy</span> <span class="token punctuation">{</span>
  <span class="token class-name">FallibleTicTacToeStrategy</span> strategyToTry<span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token class-name">Coord</span> <span class="token function">chooseMove</span><span class="token punctuation">(</span><span class="token class-name">TicTacToeModel</span> model<span class="token punctuation">,</span> <span class="token class-name">Piece</span> forWhom<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IllegalStateException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Coord</span><span class="token punctuation">&gt;</span></span> maybeAns <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>strategyToTry<span class="token punctuation">.</span><span class="token function">chooseMove</span><span class="token punctuation">(</span>model<span class="token punctuation">,</span> forWhom<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>maybeAns<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> maybeAns<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token string">"There are no possible moves chosen by this strategy!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></div><p></p><h3>3<tt>&nbsp;</tt><a name="(part._.The_decorator_pattern)"></a>The decorator pattern</h3><p>The decorator pattern is similar to the strategy pattern in terms of how
objects delegate from one to another, but the purpose is different.  The
canonical example of decorators is a UI widget library, such as Swing.  We
might have a basic <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JPanel</span></code></span> class that just describes a rectangle of
on-screen content.  We might have a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JScrollPanel</span></code></span> class, which is a
subclass of <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JPanel</span></code></span>, that visually wraps around some other <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JPanel</span></code></span>
and adds scrollbars and the ability to scroll the view in one or more
directions.  Or a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JSplitPanel</span></code></span>, which surrounds two panels and produces a
split-screen effect.  Or a <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JGridPanel</span></code></span>, or others...  Each of these
classes obeys a fairly sophisticated interface (all the methods of the base
<span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">JPanel</span></code></span> class), and then does two things: it provides some new
functionality of its own, and delegates the rest of the functionality to inner
panels.  Visually, each surrounding panel <span class="emph">decorates</span> the inner ones by
adding borders, scrollbars, splitters, etc.  Just as with the strategy pattern,
each class is responsible for one fragment of functionality: the complete
functionality comes about by composing several decorators together around some
base object.</p><p>Unlike strategies, where there can often be useful strategies
that do not need to delegate at all; decorators are all about the delegation.
Also, unlike strategies, a decorator can never be a "partial" function —<wbr> the
underlying thing being decorated is already a complete thing, and the
decoration adds more functionality on top of it, but there’s never a notion of
an "incomplete" object.</p><h3>4<tt>&nbsp;</tt><a name="(part._.Strategies__.Decorators_and_.Inheritance)"></a>Strategies, Decorators and Inheritance</h3><p>When should you use a strategy pattern or a decorator pattern, instead of just
using inheritance to customize behavior?  After all, don’t subclasses
specialize the behavior of their superclasses?  For example, could we produce
the same effect by having our <span class="sourceCode"><code class=" sourceCode language-java"><span class="token class-name">User</span></code></span> class just have an abstract method
<span class="sourceCode"><code class=" sourceCode language-java">chooseMove</code></span>, and then creating subclasses that define various
possible implementations for that method?</p><p>Yes...but only sometimes.  The power of the strategy and decorator patterns
comes from the dynamism inherent in ability to delegate from one simple
strategy to the next, or from one decorator to its contained content.  Rather
than being fixed at compile time, we can use higher-order strategies to
mix-and-match strategy pieces, or decorate panels into elaborate UIs, without
having to hard-code those choices in advance.  Additionally, the strategy or
decorator classes are appealingly tiny, self-contained, and easy to read: they
have very high cohesion, because they’re built to do exactly one thing and
nothing else.</p><a name="(part._(gentag._16._lecturestrategies_decorators))"></a><p class="FootnoteBlock"></p><p class="FootnoteBlockContent"></p><p class="FootnoteBlockContent"><span class="FootnoteTarget"><span style="vertical-align: super; font-size: 80%"><a name="(counter-()._(gentag._17._lecturestrategies_decorators))"></a>1</span></span>It’s not perfect —<wbr> suppose
two players were following this same strategy.  Would the game end in a win,
loss, or tie for the first player? How could you fix any problems you might
encounter?</p><p></p><p></p></div></div><div id="contextindicator">&nbsp;</div></body><style>
@media print {
  #simplifyJobsContainer {
    display: none;
  }
}
</style><div id="simplifyJobsContainer" style="position: absolute; top: 0px; left: 0px; width: 0px; height: 0px; overflow: visible; z-index: 2147483647;"><span><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://pbanhockgagggenencehbnadejlgchfc/css/styles.css"><style>
  :host {
    all: initial;
    line-height: 1.5;
    -webkit-text-size-adjust: 100%;
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    font-family: Palanquin, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  }
  * {
    font-family: Palanquin, ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
    scrollbar-width: thin;
    scrollbar-color: rgba(203, 213, 225, 1) transparent;
  }
  *::-webkit-scrollbar {
    width: 6px;
  }
  *::-webkit-scrollbar-track {
    background: transparent;
  }
  *::-webkit-scrollbar-thumb {
    background-color: rgba(203, 213, 225, 1);
    border-radius: 3px;
    border: 0;
  }
</style><div id="simplifyJobsPortals"></div></template></span></div><script id="simplifyJobsPageScript" src="chrome-extension://pbanhockgagggenencehbnadejlgchfc/js/pageScript.bundle.js"></script></html>